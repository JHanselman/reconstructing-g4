/***
 *  Reconstructing genus 4 curves
 *
 *  Jeroen Hanselman
 *  Andreas Pieper
 *  Sam Schiavone
 *
 *  See LICENSE.txt for license details.
 */


AttachSpec("~/reconstructing-g4/magma/spec");


CC<I> := ComplexField(300);
Pi :=  KMatrixSpace(ComplexField(300), 4, 8)!
[ ComplexField(300) | -76.9372521489463160691685496404103140834502732772110358218222923630940567495051841059486587258999693874900376459231959586683276939857376207100225438635397570905873162430237931133852246108653642539412138829574222433846243227072846621837871253957219875830621280161983167916487254900618267009676869878485p300 + 3.17304448907860563663646670866318457168313985830728480668522906555419978393447781326277824822445379687300108658767654339700554153400254151766483101619489971929665464290951437428256852389046118648415407420913635978627605951908444651524411172879740088366045529689885836976008575772999583086932796166073p300*I, 13596.5261725399357979223440438248379319212292168493288755701235228697943987950163929821447734750779551975863602583801129715386788095793697304441266117177524708859538746237373553703354595073120215788952028745366136149955649919793205604445590255898122245296454596459816216144197980173260322505394669890p300 - 3339.09274815483441847562155607038709754077787697937186738144309471775311531609522161879733457724262587089197985939567818077979010136635282554486894298540631906172664471082117112353090426282173213845023550485435426225980863116642012842710978513742591320772882721032093684357493080153334478102151348536p300*I, -355.354793581526483511612377832944208013088747824848970691836263951170567385423810662537516030553744021460718468255810123274923400259093880487624735548974807470513438193436081454015474731025289245540309240818099977001786099286526894526185659836336161287690821341492275005178924004806049718549168360073p300 - 24322.5238276516975066637532967293700803336463305437793432044512588161392159790045977703623516143452957472200242168452799766526546977109773639398753864532386383788201936537328679447868233109894797432703669949126397976006202295849153022489033878370698232191625083582482914373232551264120845161835511014p300*I, -417.683970971287708016584540905077351973518507140529360936137074921121880186930324488753460007037668550127883390806726769700721789008383344915409131443357531966455467084271400847438072130666777037321985202079585905359686985482005144206401231824645065008125054798930516536804218075812060611849067013556p300 - 2037.46333627022029617463893833058567515319960727196471418686961733065398294053351679038780769763267724186510111186685285119084056861711093324937954945057705735206836030752700647220322852800382614313399374906140923104035133073024625143652808489077549842750797251220265969097248174313995542893686471011p300*I, -90.2054855961012553744974459444173431199156186193788862660962622231111965481063666582472938861188714661308994229203847826492520033528286406036745690849003901013487873212950553924184523932736402681602614570844886848781614324205667177026360527714575010004772546473785618214331626231419990802414361801716p300 + 52.5610179837583339300936887435115467807831266247877067151904330098121029201986156945452166611612481116469920624371354254914996342894141471316501531973029315652692801542997232279250372919783768184114753830879962524529588482819880981913756641263912343085541518023289364387409719236889278090295480669119p300*I, 8588.92636766141174300710282587893734944833072890769966420799813291192604892024192027045034386721162727058775647658966326145664264040299877251542122155038237452216090497744138466448571260776195019041843396273369107842834082170428806941073045324280821689006201764920005919223653619956834896859084892456p300 - 3646.52451841521265094843455181134338753159811068989726277170296303725281659348049959282817807854024438118157063245969451639272244210005858586145665640109347018281276474468526916515745835387434562001993952393171644758600196172584195920797268549013548860267696977968666372698421227750335669029299444780p300*I, 924.845028860493652492381623258380843887368571285788992252496983245194890936472372860350657512464506022546639880460493934754690605934044359400898219939037376629616723622194011229802750178921179020230677840746421209917750253462222772997657156949661332638486718353632429812884323096335540251679017700169p300 + 4332.67033163760869221927531940405772444954008562053264028098005700456962555800259098786646251352652238765906413988678383278104346993550478776168019561300640798412852498234883500340777280260251078150541709401105863225914028967602002959540476813694121286609283282066231418923653116912787111649322295028p300*I, 32.2128292616643800227412007744047109659642116478418336935991373863930992653414099683427539793259317548432146446232211266059790127505078828063264122885190144155627148132602685613415578417880295139267604850900851155797049895711882559470246720714188747604698126759164482368892886035793631605318120344963p300 + 446.905292123301106261309424314578488704797121556533943380239401451182131772768477517234553034078813294204520007049065219760327080627786334272057930711717527463921930027649045038221319136029078536044783334277594150377969868633412129162410874166226632651991038685734999053096537236166223485578616412254p300*I, -10.7600135238375466307136105596455032550159977052131727595310792516484163549644143087725370261626640933911970771913742811802238761383052672772021653304678505540074955491985726962348158936470590986512703444509231793298193034809856176987755983171340123220153497044445350277093259161149107948077019598536p300 + 39.4244588724613926201552303596831741062738380377112213433375756086769897482715108057476946792446709258390764243224258535075998003671414283499524353583008181387604178778628602956629599979607362212161600143261105186459445020110615184596709617203673630181670865698002755798477761922069625262977419116122p300*I, 2039.20884818871318661198694391266222076299947291959028203873742245605841255184236255524585816873203876558519493341462436093328065564303216091823111718463987424773130049071331214122899855378340949801404177509418978509079840916083508108876796398378734071719312244748883107828835343883419014211516529186p300 - 3878.85403003254077930988499658803802807667892429456876640236955117645879483787151188937317540810293086018116593723377281757731723962878994155730822333046643335413472238585196686439330288505646991699511690410586941005524718177481919288912214489697525661322838755206561916782276004447012334078933512402p300*I, -2249.27434778922719839511742381105729829435698295832252572011026488725900308945046995425092248937504452611801355178621992569721330456325031970586893971252820752908045491668732334196041479835133091299700426337125190415962177833231745729037994315576445615639185728659016444568738522573189232874530379884p300 - 15858.1061138446742376876784635341408955891142326724691178024559048453793128811376776454123179725104567883692897892777187636002056566420472318396361569252916910588215606357161757444863328051508239349540248186840161840586288064014886416781481968431628029303067229432128986385794725523205019543797954586p300*I, -266.656186271826752281675067901392065145329843645680001057162788161425681188615997197403514216758708584332401865768694699557531285084528434560727258568769251058607806108232396339229349784129851342223699506033946967586681645719211520389723795390806517270520668682164571858341783584525608292747335849529p300 - 1233.61127106350525339971983274819602966086172978141831162896772633225307624352006341143314435600788928677297239501064992797974940162383179060330392478357664445567001322529212601570405598167198109116635545600765921708221417166427452106994396231150501252696387489022146108952443389103273302078795284462p300*I, -15.8057333035450856448232276453608318372655028380258809478863161413670403310676680925691048379875423910266403396568727699747758624594414761614273915717941395728479073661810477610274655672939556205279211564763582639326800202749237931040917798758636978677735403871878764877336656324961496776309439158422p300 + 14.6027454037302551499349442591854165693409828513697151633315946187840684525517879824075355267639898030343051159375038932053969831436611144789094040192256648880634487942295481494152982388912567274266132371358344428717965448961341885604567961103036856417586547425698204575530923903702940868890586959251p300*I, 1150.22924318901354510378402776944766696343944941456719501432165800189693309261677801563309718201330047798408158159842311816599746042589152942192627123214608354142043316968892964296027093290006188509418097650470341243236514426622216575231307100192815300876595607150530128951555148606220184340967001024p300 - 3456.51001336438350327086324145077837917331326528968035990197337056996575813445358836087641667693592545976939019696737172394171287057918356527892714478973740060051615858801320997550601231492444718894405506756331060055822729845418909149788171531149774244154649916752062696209304472034528725663487451510p300*I, 548.032726328237841086011289901962435358836095965761817912257684727379655767738143859567499198973556643964632871489238213903569714215149503254794749966055527490635092726220973981790339926043589183207966117892425003097003414255275432511994580382797091838721706405564523741701077773648593336685382925917p300 + 2720.51776907486512396953215442602406048292386096891663446962098386561892811686456712502648489848855559609224546522917642703212679516393546022151503353130585919702819022443537865677416250229452096527089205468821659855184664169818106142535361604464329837875821110102345314276700173436363996315039069828p300*I, 45.0740171319719566966954151194414849969743868856078263103626568727763862224155530662602803174304725249229470617937197667228048804881378113977514937675980471116665845366193189157270855930809900248567881798564268912801084398292899435708618855193249499566102819098593560635762562862634342138235957493951p300 + 237.864579709327660324152144130277785491763371705987242638116442563215166205399572869267442182081963659717662412010963022564384758926258496361664611201244785183782217447070871826401803138831715892506673489231803848849692786848805880685607839261850556322360812860501949160334111741177203362234538546657p300*I, -18.3334731822443140960245437877172089649487237142494605118755105317232151672575812005914506678520485943670476146986002482375770422639370312120942557690474047664901900678118012766230947201381476632564292879346005662800145627267837641009447912288163211998124085334382007937248550377618884046910894756781p300 + 23.7562357664987229101123792792194146251936815031786657199011231957048037800101563485205197209729594225578033678947871350623235205732257298922162535710773630430563268464313485580045290339827677726801047286412221190048311122919112508824193918283045778048435721182253748685261452001085130611474439805640p300*I, 4540.12520309160288510351689365641549527937422756102252015032624285600528562811497775295370827007676562103104449778410416360199784936679104793923250323063941267120571902025527588369873775003223475420668674667819518137846139391456762118937565567940758647953007516521191109380821218796637407193982022912p300 - 3553.74324138128588452246428616393677801648760370664766778686162277140812693348486294758762137997377741526376242769743734272640812365055670642635071297968314010001136793584613913306978642052509738661834671298077891409538169270218288540565998503671933891530754962125744244345079237350517731456721949563p300*I, -299.708214636297728503839456457424242945445818835436245165884665230701141076643173999128813763906557585114847726277645959526646734296384598552252597300282909977059444775993863058754246102451902805282952060768286974600634026229708986177884216083219719991215825055988554590251862619804733948689255406749p300 - 10697.8106213733789716240260602247317665706808508107391495571170968463518647842735787190585197822514028413495609092749573016476632958215941358147575401533883296078022540586499571003564281599100305227238976065892277811649855274030631229243794382716762725790360105032975299323793908117451945548264780533p300*I, -136.237846223425151011164775597533198997828244025752233638366203116225282328794869360117196191701891335730565325655259703918747914650389253479390238708128209277667700927593567947636143427378802365081767839232872074201869568806914499266102481414067272173862793913123944526990255597460689973514636314247p300 - 736.287593229025554415001893525613981159121247433258591348005983946343897559347933083211537040359859123431410001148904108532576696989070069317131159038246055189151673853114887450248748795675307097007693853005024566337916412085657913802794342420054851170424561276046362360262625480887827086334291797150p300*I, -37.7425659057584594259181459226195190258696049724885352340820769092914515788001085967434115603313659954155351414842679839303724296533680032351671681281916823639646534057694370445434060177448768846998471756299788084772606548018571629850445315851367218513984428030715908982078260092723111645253624766565p300 + 26.0515313964765080302469762913925986901390025782636464206821340331548386190113070268279271952003511453372252677178437779530547482618619286519913690868029044382597945041739058692098068375307964716062653898017719398306049993473067155055180125511977938888768615394061202427029585456183608339171460249004p300*I, 2856.22687296943618979106292662342186425648607761816382126649388202401014098162999988836694188181300719380190370671448120815675313083003926475178239976320199554502556741418434200896220225820554775213607136793985395058431566971495447031733803408503239361424985498483158873814433669968293585813248839021p300 - 2927.11229741097415543250807803982323293504338994872612363797596722403836060239834760518335091874494873769078154970694759585256503761866019234289212983049426182500711743426434905567396299782311140163780642955312915864148944501134138114530502298856605825351217276908331480957571163895564060826859951571p300*I, 343.341670010888880268016938311555213816835236207339589263298077316936148073166886448802004210164265891308629606876160006229887890491549198281333535479955577315970205377213810777011366511798752608136329998843090386732150126098349050168769240661858862962678031366399680897385371135781341861832819430609p300 + 1781.58781443982299287940780448305162880081207526036255768665878257278216570408370897326789670245730403773662463120443878603382258078214778038933728495540383871619356974397592804580559171121127273362643225476168359474290391631607463553887983907250106682884191913901275813838643859715794099318253858424p300*I, 1.85916591427675984870693975414153103716623343663582318116858891814500643343200636684294442735159870522009672278135017467168127630846270554191515134943799267731561078639713094894611260649092598783053941105818929222323667255875070410870977615327798210153989980729247219833054292191330569789892751195936p300 + 78.6993504243010064194020262195407041018187453287804299742226233101707133451854584184544744685027117933762679621576126209461005796154088523764129229959980914473795758104275799820936345046683284717207671870720718261060698583738562922632264277069669195263701708776288628125971234475901819567247566223225p300*I, -2.52773987869922845120131614235637712768322087622357956398919439035617483618991310802234582986450620334040727504172747826280117980449555505066686419725326519364228270163075351559562915284419204272850813145824230234733454245185997099685301135295262333203886814625032430599118940526573872706014555983589p300 - 2.47872093358534448706693486347463242955247151767578138205647994766473614442537728225117047533616538120652404109635617024097018558530547077373406756000197675655520239970551139058606904056137815887063021496223114198620205353888155611245622594165605651395686677551666793817340901017115328002528221313742p300*I, 1267.22841259449935023159319180247266384775139201421105207095833701630926549028108293585277775345817545694007306478932326050979089185067560373716595473995762048625563538387792110699747378751561710941041858882413272110908363866412878514054724039954253352650731884348634392533153884961356749812081307029p300 + 186.050473773069078758125215628494010355761268040572423229976904233878286648648532921987163235848933560217129375718340618696603893827236227089018062014710677600235361669134567752711699452700950379350101175434837392064836119892119849744438666475509632256988574636664097795216317547042621337093621423950p300*I, -320.486938160241834183415150425949336687612894001367342133551613384579420617022352236045115384467560905568660480220693556406501703719667948031938715570565095759576007257608064750191567422464949288118963968020778182608076674410795557979244444527329671162888306081404101298211885884891747592806105769024p300 - 3046.27663433865047868243458705394147114588793226325482448427360208631964136567671615457368695254247782044103970771302693503847941402799691463216590380472145780503979146533819937827923712067188371094787129585029931055543044174469405706749763104507385862337972025931007285175306417182203129736302334742p300*I, -74.5843093925920979431012666247718778955112150291067683489028489207755962824411604622535006814636806302876924011283409477357546138076961024063833607625751441152660250948209367796313048700229998536338731424937248227748843336020214598539838301402802828180322431547367362400659457846865733106014018260338p300 - 313.409970722644664473931258122840255145039153910291888706358010668972581264492762349734772792257046992362545410011411635052746120516207048432250095245594451293294690173213261378874648003248327380980479591833978729042774554777700511333438687299407898454090535792397291300528008953645157979098323802031p300*I, -13.2779934248458571936219115030044547095822819618023013838971217510108654948777549845467590081230361876862330646151452917119746826549459211107605273745408743792056246645502942454318364144497635777994130250181159615853454778230638221072387685229110745357346722409375521817424762272304109505707983560063p300 + 0.424097207819537323575832809250545146626901772311625905003223740470990528109338229986514159638402220847324272215387428304250200987895022137200410700024232157539216349287098019356917871156578385966027891262920262817139828752155320347097529539000612610840853631152461736436888104614643729810403049210951p300*I, 782.538408396502504450716415913251945213598253264138447550901624840239503371964348272309140472259517604218104415089540064351211857219988007389449807054838772211591682237011262289143290126204864819369731489339690927946211201153794740135370084783991665943870977245611414866259342803270020934969947878262p300 - 72.9247045777707472863749594292167450920645880019832645626001611508277651714223965289069894409399620805408001513298163410467441526593643893422954391385176139838408236921817539988256901491819333504919487875859459638898523361739679486871473557562706538639009407755932038178079681453993846366576499229159p300*I, 139.424400088855930176567452929106996542911515721929118645552851087798899871466116777070819576175170928145911865339408018041618624663062756821700313600016505619192501958178912063482680494534772899127879240200117866581493613042101970562708886819518975618081084788574813788684052391928623158438950758276p300 + 577.622792830517459790552320012460043456356300449324930032271847814952924642346250759759706033736689718072075935610242043761581327369214166790199780209041429426553546989744207430554612313437121731502097215507009840781004777222169567995741311565034582225288479197971692054763081589815250616942512228348p300*I, 13.7045589570750556015826238599695610612713253054730610906538759066321697289579393034241155260456657143381049996777484110381738708601168148472044754231829574307515331920205701028767537096480542082491638061609396675620958734978077231790301647450916349936484208576895036887560238659269894191468621607966p300 + 103.758639760467856753724818601148005450394727349561723204095968075138211184741668266129054574864291056633674063773259751185336443642791482051949563359388914691874689598712149067035479827596933523614861596506141985983605693687107751139834311049310665113632468696355636842829416030404329301943791306682p300*I ];


CC1:= ComplexField(150);
Pi := ChangeRing(Pi, CC1);
Pi1, Pi2 := SplitBigPeriodMatrix(Pi);
tau := -Pi1^(-1) * Pi2;
tau := (tau+Transpose(tau))/2;
tau_red, Q := SiegelReduction(tau);
err := Abs(SchottkyModularForm(tau_red : prec := 150));
print "Absolute value of Schottky modular form is", err;
Eqs := RationalReconstructCurveG4(HorizontalJoin(Pi2, Pi1));
print "Curve found! The equations are:", Eqs;
